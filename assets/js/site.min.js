document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("mobile-menu-button"),t=document.getElementById("mobile-menu");e&&e.addEventListener("click",()=>{const n=e.getAttribute("aria-expanded")==="true";t&&t.classList.toggle("hidden"),e.setAttribute("aria-expanded",!n)}),document.querySelectorAll(".copy-button").forEach(o=>{o.addEventListener("click",()=>{const e=o.parentElement.querySelector("pre"),t=e.textContent||e.innerText;navigator.clipboard.writeText(t).then(()=>{const e=o.innerHTML;o.innerHTML='<svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',setTimeout(()=>{o.innerHTML=e},2e3)})})});async function n(e,t,n,a){const o=document.getElementById(e);o&&o.addEventListener("submit",async e=>{e.preventDefault();const i=document.getElementById(t),d=document.getElementById(n),l=d&&d.parentElement;i&&i.classList.remove("hidden"),l&&l.classList.add("hidden"),d&&(d.textContent="");try{const e=await a(e);d&&(d.textContent=e),l&&l.classList.remove("hidden")}catch(e){console.error("Processing error:",e),d&&(d.textContent=`An error occurred: ${e.message}`),l&&l.classList.remove("hidden")}finally{i&&i.classList.add("hidden")}})}async function a(e,t=null){const n=await fetch("https://a1utilityhub.onrender.com/api/prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,inlineData:t})}),a=await n.json();if(a.error)throw new Error(a.error);if(a.candidates?.[0]?.content?.parts?.[0]?.text)return a.candidates[0].content.parts[0].text;throw new Error("No response from Gemini")}n("ai-prompt-form","ai-prompt-loading","ai-prompt-output",async e=>{const t=document.getElementById("ai-category")?.value,n=document.getElementById("ai-topic")?.value;if(!n)throw new Error("Please enter a topic.");const o=`Generate a single, creative and effective AI prompt for a user interested in '${t}' with the topic '${n}'. The prompt should be formatted so that it can be directly copied and used in an AI tool like ChatGPT or Midjourney.`;return await a(o)}),n("instagram-form","instagram-loading","instagram-output",async e=>{const t=document.getElementById("instagram-keywords")?.value,n=document.getElementById("instagram-type")?.value;if(!t)throw new Error("Please enter some keywords.");const o="bio"===n?`Generate 3 creative and catchy Instagram bio options using the keywords: '${t}'. List them with a number and a sparkle emoji, one per line.`:`Generate 5 unique and cool Instagram username ideas using the keywords: '${t}'. List them with a number and a sparkle emoji, one per line.`;return await a(o)}),n("text-rewriter-form","text-rewriter-loading","text-rewriter-output",async e=>{const t=document.getElementById("rewriter-text")?.value,n=document.getElementById("rewriter-style")?.value;if(!t)throw new Error("Please enter text to rewrite.");const o=`Rewrite the following text in a '${n}' tone: '${t}'. The rewritten text should maintain the original meaning but reflect the new style.`;return await a(o)});const o=document.getElementById("tax-calculator-form");if(o){o.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("tax-calculator-output"),n=t?.parentElement;try{const e=parseFloat(document.getElementById("tax-salary").value),a=document.getElementById("tax-regime").value,o=parseFloat(document.getElementById("tax-deductions").value)||0;if(isNaN(e)||e<=0)throw new Error("Please enter a valid gross annual salary.");let i,d=0;"new"===a?(i=e-5e4,i<=3e5?d=0:i<=6e5?d=.05*(i-3e5):i<=9e5?d=15e3+.1*(i-6e5):i<=1200000?d=45e3+.15*(i-9e5):i<=1500000?d=9e4+.2*(i-1200000):d=15e4+.3*(i-1500000)):"old"===a&&(i=e-5e4-o,i<=25e4?d=0:i<=5e5?d=.05*(i-25e4):i<=1e6?d=12500+.2*(i-5e5):d=112500+.3*(i-1e6)),i<0&&(i=0),("new"===a&&e<=7e5||"old"===a&&i<=5e5)&&(d=0);const r=.04*d,c=d+r;t&&(t.textContent=`--- Tax Calculation (${a.charAt(0).toUpperCase()+a.slice(1)} Regime) ---\nGross Annual Salary: â‚¹${e.toLocaleString("en-IN")}\nTaxable Income: â‚¹${i.toLocaleString("en-IN")}\nTax before Cess: â‚¹${d.toFixed(2).toLocaleString("en-IN")}\nHealth & Edu Cess (4%): â‚¹${r.toFixed(2).toLocaleString("en-IN")}\n-----------------------------------------\nTotal Tax Payable: â‚¹${c.toFixed(2).toLocaleString("en-IN")}`),n&&n.classList.remove("hidden")}catch(e){t&&(t.textContent=`An error occurred: ${e.message}`),n&&n.classList.remove("hidden")}});const e=document.getElementById("tax-regime");e&&e.addEventListener("change",e=>{const t=document.getElementById("tax-deductions");t&&(t.disabled="new"===e.target.value),"new"===e.target.value&&t&&(t.value=0)})}const i=document.getElementById("love-calculator-form");i&&i.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("love-calculator-output"),n=t?.parentElement,a=document.getElementById("love-name1").value,o=document.getElementById("love-name2").value;if(!a||!o)return t.textContent="Please enter both names.",void(n&&n.classList.remove("hidden"));const r=Math.floor(101*Math.random()),s=["A match made in heaven! â¤ï¸","It's a strong connection! Keep it going.","Seems like there's some potential here.","It's complicated, but nothing is impossible!","Maybe try again with different names? ðŸ˜‰"];let l;r>90?l=s[0]:r>60?l=s[1]:r>30?l=s[2]:l=s[Math.floor(2*Math.random())+3],t.textContent=`Love Score for ${a} and ${o}:\n\nâ¤ï¸ ${r}% â¤ï¸\n\n${l}`,n&&n.classList.remove("hidden")}),!0){const e=document.getElementById("celebrity-form");e&&e.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("celebrity-image"),n=document.getElementById("celebrity-loading"),o=document.getElementById("celebrity-output"),i=o?.parentElement,d=document.getElementById("celebrity-image-preview");if(0===t.files.length)return void alert("Please upload an image.");n&&n.classList.remove("hidden"),i&&i.classList.add("hidden"),o&&(o.textContent=""),d&&d.classList.add("hidden");const l=t.files[0],r=new FileReader;r.onload=async()=>{d&&(d.src=r.result,d.classList.remove("hidden"));try{const e='Analyze the person in this image and tell me which celebrity they most resemble. The response should be a fun and concise statement, starting with "You look like..."',t=await a(e,"image_data_here");o&&(o.textContent=t),i&&i.classList.remove("hidden")}catch(e){o&&(o.textContent=`An error occurred: ${e.message}`),i&&i.classList.remove("hidden")}finally{n&&n.classList.add("hidden")}},r.readAsDataURL(l)})}});
