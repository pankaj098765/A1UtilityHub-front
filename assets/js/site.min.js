document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("mobile-menu-button"),t=document.getElementById("mobile-menu");e&&e.addEventListener("click",()=>{const n=e.getAttribute("aria-expanded")==="true";t&&t.classList.toggle("hidden"),e.setAttribute("aria-expanded",!n)}),document.querySelectorAll(".copy-button").forEach(o=>{o.addEventListener("click",()=>{const preElement=o.parentElement.querySelector("pre"),textContent=preElement.textContent||preElement.innerText;navigator.clipboard.writeText(textContent).then(()=>{const originalHTML=o.innerHTML;o.innerHTML='<svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',setTimeout(()=>{o.innerHTML=originalHTML},2e3)})})});function n(formId,loadingId,outputId,processFunction){const form=document.getElementById(formId);form&&form.addEventListener("submit",async submitEvent=>{submitEvent.preventDefault();const loadingElement=document.getElementById(loadingId),outputElement=document.getElementById(outputId),outputContainer=outputElement&&outputElement.parentElement;loadingElement&&loadingElement.classList.remove("hidden"),outputContainer&&outputContainer.classList.add("hidden"),outputElement&&(outputElement.textContent="");try{const result=await processFunction(submitEvent);outputElement&&(outputElement.textContent=result),outputContainer&&outputContainer.classList.remove("hidden")}catch(error){console.error("Processing error:",error),outputElement&&(outputElement.textContent=`An error occurred: ${error.message}`),outputContainer&&outputContainer.classList.remove("hidden")}finally{loadingElement&&loadingElement.classList.add("hidden")}})}async function a(promptText,inlineData=null){const response=await fetch("https://a1utilityhub.onrender.com/api/prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:promptText,inlineData:inlineData})}),responseData=await response.json();if(responseData.error)throw new Error(responseData.error);if(responseData.candidates?.[0]?.content?.parts?.[0]?.text)return responseData.candidates[0].content.parts[0].text;throw new Error("No response from Gemini")}n("ai-prompt-form","ai-prompt-loading","ai-prompt-output",async submitEvent=>{const category=document.getElementById("ai-category")?.value,topic=document.getElementById("ai-topic")?.value;if(!topic)throw new Error("Please enter a topic.");const promptText=`Generate a single, creative and effective AI prompt for a user interested in '${category}' with the topic '${topic}'. The prompt should be formatted so that it can be directly copied and used in an AI tool like ChatGPT or Midjourney.`;return await a(promptText)}),n("instagram-form","instagram-loading","instagram-output",async submitEvent=>{const keywords=document.getElementById("instagram-keywords")?.value,type=document.getElementById("instagram-type")?.value;if(!keywords)throw new Error("Please enter some keywords.");const promptText="bio"===type?`Generate 3 creative and catchy Instagram bio options using the keywords: '${keywords}'. List them with a number and a sparkle emoji, one per line.`:`Generate 5 unique and cool Instagram username ideas using the keywords: '${keywords}'. List them with a number and a sparkle emoji, one per line.`;return await a(promptText)}),n("text-rewriter-form","text-rewriter-loading","text-rewriter-output",async submitEvent=>{const text=document.getElementById("rewriter-text")?.value,style=document.getElementById("rewriter-style")?.value;if(!text)throw new Error("Please enter text to rewrite.");const promptText=`Rewrite the following text in a '${style}' tone: '${text}'. The rewritten text should maintain the original meaning but reflect the new style.`;return await a(promptText)});const o=document.getElementById("tax-calculator-form");if(o){o.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("tax-calculator-output"),n=t?.parentElement;try{const e=parseFloat(document.getElementById("tax-salary").value),a=document.getElementById("tax-regime").value,o=parseFloat(document.getElementById("tax-deductions").value)||0;if(isNaN(e)||e<=0)throw new Error("Please enter a valid gross annual salary.");let i,d=0;const l=5e4;"new"===a?(i=e-l,i<=3e5?d=0:i<=6e5?d=.05*(i-3e5):i<=9e5?d=15e3+.1*(i-6e5):i<=1200000?d=45e3+.15*(i-9e5):i<=1500000?d=9e4+.2*(i-1200000):d=15e4+.3*(i-1500000)):"old"===a&&(i=e-l-o,i<=25e4?d=0:i<=5e5?d=.05*(i-25e4):i<=1e6?d=12500+.2*(i-5e5):d=112500+.3*(i-1e6)),i<0&&(i=0),("new"===a&&e<=7e5||"old"===a&&i<=5e5)&&(d=0);const r=.04*d,c=d+r;t&&(t.textContent=`--- Tax Calculation (${a.charAt(0).toUpperCase()+a.slice(1)} Regime) ---\nGross Annual Salary: ₹${e.toLocaleString("en-IN")}\nTaxable Income: ₹${i.toLocaleString("en-IN")}\nTax before Cess: ₹${d.toFixed(2).toLocaleString("en-IN")}\nHealth & Edu Cess (4%): ₹${r.toFixed(2).toLocaleString("en-IN")}\n-----------------------------------------\nTotal Tax Payable: ₹${c.toFixed(2).toLocaleString("en-IN")}`),n&&n.classList.remove("hidden")}catch(e){t&&(t.textContent=`An error occurred: ${e.message}`),n&&n.classList.remove("hidden")}});const e=document.getElementById("tax-regime");e&&e.addEventListener("change",e=>{const t=document.getElementById("tax-deductions");t&&(t.disabled="new"===e.target.value),"new"===e.target.value&&t&&(t.value=0)})}const i=document.getElementById("love-calculator-form");if(i&&i.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("love-calculator-output"),n=t?.parentElement,a=document.getElementById("love-name1").value,o=document.getElementById("love-name2").value;if(!a||!o)return t.textContent="Please enter both names.",void(n&&n.classList.remove("hidden"));const i=Math.floor(101*Math.random()),d=["A match made in heaven! ❤️","It's a strong connection! Keep it going.","Seems like there's some potential here.","It's complicated, but nothing is impossible!","Maybe try again with different names? 😉"];let l;i>90?l=d[0]:i>60?l=d[1]:i>30?l=d[2]:l=d[Math.floor(2*Math.random())+3],t.textContent=`Love Score for ${a} and ${o}:\n\n❤️ ${i}% ❤️\n\n${l}`,n&&n.classList.remove("hidden")}),!0){const e=document.getElementById("celebrity-form");e&&e.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("celebrity-image"),n=document.getElementById("celebrity-loading"),o=document.getElementById("celebrity-output"),i=o?.parentElement,d=document.getElementById("celebrity-image-preview");if(0===t.files.length)return void alert("Please upload an image.");n&&n.classList.remove("hidden"),i&&i.classList.add("hidden"),o&&(o.textContent=""),d&&d.classList.add("hidden");const l=t.files[0],r=new FileReader;r.onload=async()=>{d&&(d.src=r.result,d.classList.remove("hidden"));try{const e='Analyze the person in this image and tell me which celebrity they most resemble. The response should be a fun and concise statement, starting with "You look like..."',t=await a(e,"image_data_here");o&&(o.textContent=t),i&&i.classList.remove("hidden")}catch(e){o&&(o.textContent=`An error occurred: ${e.message}`),i&&i.classList.remove("hidden")}finally{n&&n.classList.add("hidden")}},r.readAsDataURL(l)})}});